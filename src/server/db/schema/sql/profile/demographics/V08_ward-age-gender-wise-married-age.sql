--DUMMY DATA
-- Create the enums if they don't exist
DO $$ BEGIN
    CREATE TYPE married_age_group AS ENUM (
        'AGE_BELOW_15', 
        'AGE_15_19', 
        'AGE_20_24', 
        'AGE_25_29', 
        'AGE_30_34', 
        'AGE_35_39', 
        'AGE_40_AND_ABOVE'
    );
EXCEPTION
    WHEN duplicate_object THEN null;
END $$;

DO $$ BEGIN
    CREATE TYPE gender AS ENUM (
        'MALE', 
        'FEMALE', 
        'OTHER'
    );
EXCEPTION
    WHEN duplicate_object THEN null;
END $$;

-- Create the empty acme_ward_age_gender_wise_married_age table
CREATE TABLE IF NOT EXISTS acme_ward_age_gender_wise_married_age (
    id VARCHAR(36) PRIMARY KEY,
    ward_id VARCHAR(36),
    age_group married_age_group NOT NULL,
    gender gender NOT NULL,
    population INTEGER NOT NULL,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(ward_id, age_group, gender)
);

-- Insert dummy data
-- First, ensure we have ward_wise_demographic_summary entries
DO $$ 
DECLARE
    ward1_id VARCHAR := '12345678-1234-1234-1234-123456789001';
    ward2_id VARCHAR := '12345678-1234-1234-1234-123456789002';
    ward3_id VARCHAR := '12345678-1234-1234-1234-123456789003';
BEGIN
    -- Check if the wards already exist
    IF NOT EXISTS (SELECT 1 FROM ward_wise_demographic_summary WHERE id = ward1_id) THEN
        INSERT INTO ward_wise_demographic_summary (id, ward_number, total_population, total_families)
        VALUES 
            (ward1_id, 1, 5000, 1200);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM ward_wise_demographic_summary WHERE id = ward2_id) THEN
        INSERT INTO ward_wise_demographic_summary (id, ward_number, total_population, total_families)
        VALUES 
            (ward2_id, 2, 4500, 1100);
    END IF;

    IF NOT EXISTS (SELECT 1 FROM ward_wise_demographic_summary WHERE id = ward3_id) THEN
        INSERT INTO ward_wise_demographic_summary (id, ward_number, total_population, total_families)
        VALUES 
            (ward3_id, 3, 3800, 950);
    END IF;
END $$;

-- Now, insert dummy data for acme_ward_age_gender_wise_married_age with explicit insert values
INSERT INTO acme_ward_age_gender_wise_married_age (id, ward_id, age_group, population, gender)
VALUES 
    -- Ward 1 data
    ('d8a7c328-1234-5678-9abc-def012345601', '12345678-1234-1234-1234-123456789001', 'AGE_BELOW_15', 120, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345602', '12345678-1234-1234-1234-123456789001', 'AGE_BELOW_15', 110, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345603', '12345678-1234-1234-1234-123456789001', 'AGE_15_19', 180, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345604', '12345678-1234-1234-1234-123456789001', 'AGE_15_19', 190, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345605', '12345678-1234-1234-1234-123456789001', 'AGE_20_24', 210, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345606', '12345678-1234-1234-1234-123456789001', 'AGE_20_24', 230, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345607', '12345678-1234-1234-1234-123456789001', 'AGE_25_29', 280, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345608', '12345678-1234-1234-1234-123456789001', 'AGE_25_29', 290, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345609', '12345678-1234-1234-1234-123456789001', 'AGE_30_34', 240, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345610', '12345678-1234-1234-1234-123456789001', 'AGE_30_34', 250, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345611', '12345678-1234-1234-1234-123456789001', 'AGE_35_39', 180, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345612', '12345678-1234-1234-1234-123456789001', 'AGE_35_39', 170, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345613', '12345678-1234-1234-1234-123456789001', 'AGE_40_AND_ABOVE', 150, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345614', '12345678-1234-1234-1234-123456789001', 'AGE_40_AND_ABOVE', 140, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345615', '12345678-1234-1234-1234-123456789001', 'AGE_BELOW_15', 10, 'OTHER'),
    
    -- Ward 2 data
    ('d8a7c328-1234-5678-9abc-def012345616', '12345678-1234-1234-1234-123456789002', 'AGE_BELOW_15', 100, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345617', '12345678-1234-1234-1234-123456789002', 'AGE_BELOW_15', 105, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345618', '12345678-1234-1234-1234-123456789002', 'AGE_15_19', 165, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345619', '12345678-1234-1234-1234-123456789002', 'AGE_15_19', 175, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345620', '12345678-1234-1234-1234-123456789002', 'AGE_20_24', 195, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345621', '12345678-1234-1234-1234-123456789002', 'AGE_20_24', 205, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345622', '12345678-1234-1234-1234-123456789002', 'AGE_25_29', 235, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345623', '12345678-1234-1234-1234-123456789002', 'AGE_25_29', 245, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345624', '12345678-1234-1234-1234-123456789002', 'AGE_30_34', 215, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345625', '12345678-1234-1234-1234-123456789002', 'AGE_30_34', 225, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345626', '12345678-1234-1234-1234-123456789002', 'AGE_35_39', 155, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345627', '12345678-1234-1234-1234-123456789002', 'AGE_35_39', 145, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345628', '12345678-1234-1234-1234-123456789002', 'AGE_40_AND_ABOVE', 135, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345629', '12345678-1234-1234-1234-123456789002', 'AGE_40_AND_ABOVE', 125, 'FEMALE'),
    
    -- Ward 3 data
    ('d8a7c328-1234-5678-9abc-def012345630', '12345678-1234-1234-1234-123456789003', 'AGE_BELOW_15', 90, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345631', '12345678-1234-1234-1234-123456789003', 'AGE_BELOW_15', 95, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345632', '12345678-1234-1234-1234-123456789003', 'AGE_15_19', 140, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345633', '12345678-1234-1234-1234-123456789003', 'AGE_15_19', 150, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345634', '12345678-1234-1234-1234-123456789003', 'AGE_20_24', 180, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345635', '12345678-1234-1234-1234-123456789003', 'AGE_20_24', 190, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345636', '12345678-1234-1234-1234-123456789003', 'AGE_25_29', 200, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345637', '12345678-1234-1234-1234-123456789003', 'AGE_25_29', 210, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345638', '12345678-1234-1234-1234-123456789003', 'AGE_30_34', 170, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345639', '12345678-1234-1234-1234-123456789003', 'AGE_30_34', 180, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345640', '12345678-1234-1234-1234-123456789003', 'AGE_35_39', 130, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345641', '12345678-1234-1234-1234-123456789003', 'AGE_35_39', 120, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345642', '12345678-1234-1234-1234-123456789003', 'AGE_40_AND_ABOVE', 110, 'MALE'),
    ('d8a7c328-1234-5678-9abc-def012345643', '12345678-1234-1234-1234-123456789003', 'AGE_40_AND_ABOVE', 100, 'FEMALE'),
    ('d8a7c328-1234-5678-9abc-def012345644', '12345678-1234-1234-1234-123456789003', 'AGE_20_24', 15, 'OTHER');